name: "XAVIOR Magic Link Full Flow"

config:
  baseUrl: "http://localhost:5175"
  timeoutMs: 30000

# NOTE: This flow requires a MAGIC_LINK_TOKEN env var to be set
# Run with the wrapper script: ./flows/xavior-test.sh
# Or manually set the token and run:
#   MAGIC_LINK_TOKEN=xxx EMAIL=test@example.com node run.js flows/xavior-magic-link.yaml

steps:
  # Step 1: Navigate directly to the magic link verify URL
  # The token and email will be injected by the wrapper script
  - type: goto
    url: "http://localhost:5175/auth/verify?token=${MAGIC_LINK_TOKEN}&email=${EMAIL}"

  # Step 2: Wait for verification to complete
  - type: wait
    ms: 3000

  # Step 3: Should see success message or redirect to main app
  - type: wait-for-url
    contains: "/"

  # Step 4: Take screenshot of final state
  - type: screenshot
    path: "screenshots/xavior-magic-link-success.png"
